import{r as u}from"./index-4g5l5LRQ.js";import{N as S,n as R,y as L,z as U,w as j,i as g}from"./real-module-R3JuiRWs.js";import{f as F}from"./import-wL4esqGM.js";const w={badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1,valid:!0},B={...w,customError:!0,valid:!1},b={isInvalid:!1,validationDetails:w,validationErrors:[]},N=u.createContext({}),P="__formValidationState"+Date.now();function X(a){if(a[P]){let{realtimeValidation:e,displayValidation:i,updateValidation:t,resetValidation:s,commitValidation:l}=a[P];return{realtimeValidation:e,displayValidation:i,updateValidation:t,resetValidation:s,commitValidation:l}}return Q(a)}function Q(a){let{isInvalid:e,validationState:i,name:t,value:s,builtinValidation:l,validate:o,validationBehavior:n="aria"}=a;i&&(e||(e=i==="invalid"));let r=e?{isInvalid:!0,validationErrors:[],validationDetails:B}:null,d=u.useMemo(()=>D(_(o,s)),[o,s]);l!=null&&l.validationDetails.valid&&(l=null);let v=u.useContext(N),f=u.useMemo(()=>t?Array.isArray(t)?t.flatMap(c=>h(v[c])):h(v[t]):[],[v,t]),[C,A]=u.useState(v),[M,m]=u.useState(!1);v!==C&&(A(v),m(!1));let p=u.useMemo(()=>D(M?[]:f),[M,f]),x=u.useRef(b),[V,y]=u.useState(b),$=u.useRef(b),T=()=>{if(!O)return;E(!1);let c=d||l||x.current;I(c,$.current)||($.current=c,y(c))},[O,E]=u.useState(!1);return u.useEffect(T),{realtimeValidation:r||p||d||l||b,displayValidation:n==="native"?r||p||V:r||p||d||l||V,updateValidation(c){n==="aria"&&!I(V,c)?y(c):x.current=c},resetValidation(){let c=b;I(c,$.current)||($.current=c,y(c)),n==="native"&&E(!1),m(!0)},commitValidation(){n==="native"&&E(!0),m(!0)}}}function h(a){return a?Array.isArray(a)?a:[a]:[]}function _(a,e){if(typeof a=="function"){let i=a(e);if(i&&typeof i!="boolean")return h(i)}return[]}function D(a){return a.length?{isInvalid:!0,validationErrors:a,validationDetails:B}:null}function I(a,e){return a===e?!0:a&&e&&a.isInvalid===e.isInvalid&&a.validationErrors.length===e.validationErrors.length&&a.validationErrors.every((i,t)=>i===e.validationErrors[t])&&Object.entries(a.validationDetails).every(([i,t])=>e.validationDetails[i]===t)}function k(a){let{id:e,label:i,"aria-labelledby":t,"aria-label":s,labelElementType:l="label"}=a;e=L(e);let o=L(),n={};i?(t=t?`${o} ${t}`:o,n={id:o,htmlFor:l==="label"?e:void 0}):!t&&!s&&console.warn("If you do not provide a visible label, you must specify an aria-label or aria-labelledby attribute for accessibility");let r=U({id:e,"aria-label":s,"aria-labelledby":t});return{labelProps:n,fieldProps:r}}function Z(a){let{description:e,errorMessage:i,isInvalid:t,validationState:s}=a,{labelProps:l,fieldProps:o}=k(a),n=S([!!e,!!i,t,s]),r=S([!!e,!!i,t,s]);return o=R(o,{"aria-describedby":[n,r,a["aria-describedby"]].filter(Boolean).join(" ")||void 0}),{labelProps:l,fieldProps:o,descriptionProps:{id:n},errorMessageProps:{id:r}}}function ee(a,e,i){let{validationBehavior:t,focus:s}=a;j(()=>{if(t==="native"&&(i!=null&&i.current)){let r=e.realtimeValidation.isInvalid?e.realtimeValidation.validationErrors.join(" ")||"Invalid value.":"";i.current.setCustomValidity(r),i.current.hasAttribute("title")||(i.current.title=""),e.realtimeValidation.isInvalid||e.updateValidation(z(i.current))}});let l=g(()=>{e.resetValidation()}),o=g(r=>{var d;e.displayValidation.isInvalid||e.commitValidation();let v=i==null||(d=i.current)===null||d===void 0?void 0:d.form;if(!r.defaultPrevented&&i&&v&&Y(v)===i.current){var f;s?s():(f=i.current)===null||f===void 0||f.focus(),F("keyboard")}r.preventDefault()}),n=g(()=>{e.commitValidation()});u.useEffect(()=>{let r=i==null?void 0:i.current;if(!r)return;let d=r.form;return r.addEventListener("invalid",o),r.addEventListener("change",n),d==null||d.addEventListener("reset",l),()=>{r.removeEventListener("invalid",o),r.removeEventListener("change",n),d==null||d.removeEventListener("reset",l)}},[i,o,n,l,t])}function q(a){let e=a.validity;return{badInput:e.badInput,customError:e.customError,patternMismatch:e.patternMismatch,rangeOverflow:e.rangeOverflow,rangeUnderflow:e.rangeUnderflow,stepMismatch:e.stepMismatch,tooLong:e.tooLong,tooShort:e.tooShort,typeMismatch:e.typeMismatch,valueMissing:e.valueMissing,valid:e.valid}}function z(a){return{isInvalid:!a.validity.valid,validationDetails:q(a),validationErrors:a.validationMessage?[a.validationMessage]:[]}}function Y(a){for(let e=0;e<a.elements.length;e++){let i=a.elements[e];if(!i.validity.valid)return i}return null}export{X as $,Z as a,ee as b,P as c};
