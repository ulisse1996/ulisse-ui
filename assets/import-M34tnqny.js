import{r as b}from"./index-4g5l5LRQ.js";import{h,i as I,j as B,k as m,l as M}from"./real-module-wTCPhnlO.js";import{$ as k,a as w}from"./import-EVjeKMzd.js";import{$ as L,a as D,b as V}from"./import-tBqesvrZ.js";function T(t,i){let{inputElementType:l="input",isDisabled:o=!1,isRequired:s=!1,isReadOnly:v=!1,type:p="text",validationBehavior:c="aria"}=t,[r,d]=k(t.value,t.defaultValue||"",t.onChange),{focusableProps:u}=w(t,i),a=L({...t,value:r}),{isInvalid:e,validationErrors:n,validationDetails:P}=a.displayValidation,{labelProps:E,fieldProps:g,descriptionProps:S,errorMessageProps:C}=D({...t,isInvalid:e,errorMessage:t.errorMessage||n}),x=h(t,{labelable:!0});const y={type:p,pattern:t.pattern};return I(i,r,d),V(t,a,i),b.useEffect(()=>{if(i.current instanceof B(i.current).HTMLTextAreaElement){let f=i.current;Object.defineProperty(f,"defaultValue",{get:()=>f.value,set:()=>{},configurable:!0})}},[i]),{labelProps:E,inputProps:m(x,l==="input"&&y,{disabled:o,readOnly:v,required:s&&c==="native","aria-required":s&&c==="aria"||void 0,"aria-invalid":e||void 0,"aria-errormessage":t["aria-errormessage"],"aria-activedescendant":t["aria-activedescendant"],"aria-autocomplete":t["aria-autocomplete"],"aria-haspopup":t["aria-haspopup"],value:r,onChange:f=>d(f.target.value),autoComplete:t.autoComplete,autoCapitalize:t.autoCapitalize,maxLength:t.maxLength,minLength:t.minLength,name:t.name,placeholder:t.placeholder,inputMode:t.inputMode,onCopy:t.onCopy,onCut:t.onCut,onPaste:t.onPaste,onCompositionEnd:t.onCompositionEnd,onCompositionStart:t.onCompositionStart,onCompositionUpdate:t.onCompositionUpdate,onSelect:t.onSelect,onBeforeInput:t.onBeforeInput,onInput:t.onInput,...u,...g}),descriptionProps:S,errorMessageProps:C,isInvalid:e,validationErrors:n,validationDetails:P}}function $(){return typeof window<"u"&&window.InputEvent&&typeof InputEvent.prototype.getTargetRanges=="function"}function j(t,i,l){let o=M(a=>{let e=l.current,n;switch(a.inputType){case"historyUndo":case"historyRedo":return;case"deleteContent":case"deleteByCut":case"deleteByDrag":n=e.value.slice(0,e.selectionStart)+e.value.slice(e.selectionEnd);break;case"deleteContentForward":n=e.selectionEnd===e.selectionStart?e.value.slice(0,e.selectionStart)+e.value.slice(e.selectionEnd+1):e.value.slice(0,e.selectionStart)+e.value.slice(e.selectionEnd);break;case"deleteContentBackward":n=e.selectionEnd===e.selectionStart?e.value.slice(0,e.selectionStart-1)+e.value.slice(e.selectionStart):e.value.slice(0,e.selectionStart)+e.value.slice(e.selectionEnd);break;case"deleteSoftLineBackward":case"deleteHardLineBackward":n=e.value.slice(e.selectionStart);break;default:a.data!=null&&(n=e.value.slice(0,e.selectionStart)+a.data+e.value.slice(e.selectionEnd));break}(n==null||!i.validate(n))&&a.preventDefault()});b.useEffect(()=>{if(!$())return;let a=l.current;return a.addEventListener("beforeinput",o,!1),()=>{a.removeEventListener("beforeinput",o,!1)}},[l,o]);let s=$()?null:a=>{let e=a.target.value.slice(0,a.target.selectionStart)+a.data+a.target.value.slice(a.target.selectionEnd);i.validate(e)||a.preventDefault()},{labelProps:v,inputProps:p,descriptionProps:c,errorMessageProps:r,...d}=T(t,l),u=b.useRef(null);return{inputProps:m(p,{onBeforeInput:s,onCompositionStart(){let{value:a,selectionStart:e,selectionEnd:n}=l.current;u.current={value:a,selectionStart:e,selectionEnd:n}},onCompositionEnd(){if(!i.validate(l.current.value)){let{value:a,selectionStart:e,selectionEnd:n}=u.current;l.current.value=a,l.current.setSelectionRange(e,n),i.setInputValue(a)}}}),labelProps:v,descriptionProps:c,errorMessageProps:r,...d}}export{j as $,T as a};
