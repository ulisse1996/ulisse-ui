import{r as b,R as Rt}from"./index-4g5l5LRQ.js";import"./index-jmm5gWkb.js";import{j as Dt}from"./jsx-runtime-vNq4Oc-g.js";const Tt=Symbol(),rt=Symbol(),k="a",B="w";let Nt=(t,e)=>new Proxy(t,e);const st=Object.getPrototypeOf,it=new WeakMap,Et=t=>t&&(it.has(t)?it.get(t):st(t)===Object.prototype||st(t)===Array.prototype),at=t=>typeof t=="object"&&t!==null,Ft=t=>{if(Array.isArray(t))return Array.from(t);const e=Object.getOwnPropertyDescriptors(t);return Object.values(e).forEach(n=>{n.configurable=!0}),Object.create(st(t),e)},wt=t=>t[rt]||t,St=(t,e,n,s)=>{if(!Et(t))return t;let r=s&&s.get(t);if(!r){const v=wt(t);r=(d=>Object.values(Object.getOwnPropertyDescriptors(d)).some(i=>!i.configurable&&!i.writable))(v)?[v,Ft(v)]:[v],s==null||s.set(t,r)}const[a,h]=r;let g=n&&n.get(a);return g&&g[1].f===!!h||(g=((v,d)=>{const i={f:d};let c=!1;const o=(l,p)=>{if(!c){let y=i[k].get(v);if(y||(y={},i[k].set(v,y)),l===B)y[B]=!0;else{let m=y[l];m||(m=new Set,y[l]=m),m.add(p)}}},u={get:(l,p)=>p===rt?v:(o("k",p),St(Reflect.get(l,p),i[k],i.c,i.t)),has:(l,p)=>p===Tt?(c=!0,i[k].delete(v),!0):(o("h",p),Reflect.has(l,p)),getOwnPropertyDescriptor:(l,p)=>(o("o",p),Reflect.getOwnPropertyDescriptor(l,p)),ownKeys:l=>(o(B),Reflect.ownKeys(l))};return d&&(u.set=u.deleteProperty=()=>!1),[u,i]})(a,!!h),g[1].p=Nt(h||a,g[0]),n&&n.set(a,g)),g[1][k]=e,g[1].c=n,g[1].t=s,g[1].p},bt=(t,e,n,s)=>{if(Object.is(t,e))return!1;if(!at(t)||!at(e))return!0;const r=n.get(wt(t));if(!r)return!0;if(s){const h=s.get(t);if(h&&h.n===e)return h.g;s.set(t,{n:e,g:!1})}let a=null;try{for(const h of r.h||[])if(a=Reflect.has(t,h)!==Reflect.has(e,h),a)return a;if(r[B]===!0){if(a=((h,g)=>{const v=Reflect.ownKeys(h),d=Reflect.ownKeys(g);return v.length!==d.length||v.some((i,c)=>i!==d[c])})(t,e),a)return a}else for(const h of r.o||[])if(a=!!Reflect.getOwnPropertyDescriptor(t,h)!=!!Reflect.getOwnPropertyDescriptor(e,h),a)return a;for(const h of r.k||[])if(a=bt(t[h],e[h],n,s),a)return a;return a===null&&(a=!0),a}finally{s&&s.set(t,{n:e,g:a})}},$t=t=>Et(t)&&t[rt]||null,ht=(t,e=!0)=>{it.set(t,e)};var J=t=>typeof t=="object"&&t!==null,R=new WeakMap,W=new WeakSet,kt=(t=Object.is,e=(d,i)=>new Proxy(d,i),n=d=>J(d)&&!W.has(d)&&(Array.isArray(d)||!(Symbol.iterator in d))&&!(d instanceof WeakMap)&&!(d instanceof WeakSet)&&!(d instanceof Error)&&!(d instanceof Number)&&!(d instanceof Date)&&!(d instanceof String)&&!(d instanceof RegExp)&&!(d instanceof ArrayBuffer),s=d=>{switch(d.status){case"fulfilled":return d.value;case"rejected":throw d.reason;default:throw d}},r=new WeakMap,a=(d,i,c=s)=>{const o=r.get(d);if((o==null?void 0:o[0])===i)return o[1];const u=Array.isArray(d)?[]:Object.create(Object.getPrototypeOf(d));return ht(u,!0),r.set(d,[i,u]),Reflect.ownKeys(d).forEach(l=>{const p=Reflect.get(d,l);W.has(p)?(ht(p,!1),u[l]=p):p instanceof Promise?Object.defineProperty(u,l,{get(){return c(p)}}):R.has(p)?u[l]=L(p,c):u[l]=p}),Object.freeze(u)},h=new WeakMap,g=[1,1],v=d=>{if(!J(d))throw new Error("object required");const i=h.get(d);if(i)return i;let c=g[0];const o=new Set,u=(S,w=++g[0])=>{c!==w&&(c=w,o.forEach(E=>E(S,w)))};let l=g[1];const p=(S=++g[1])=>(l!==S&&!o.size&&(l=S,m.forEach(([w])=>{const E=w[1](S);E>c&&(c=E)})),c),y=S=>(w,E)=>{const C=[...w];C[1]=[S,...C[1]],u(C,E)},m=new Map,A=(S,w)=>{if(o.size){const E=w[3](y(S));m.set(S,[w,E])}else m.set(S,[w])},D=S=>{var E;const w=m.get(S);w&&(m.delete(S),(E=w[1])==null||E.call(w))},Y=S=>(o.add(S),o.size===1&&m.forEach(([E,C],T)=>{const $=E[3](y(T));m.set(T,[E,$])}),()=>{o.delete(S),o.size===0&&m.forEach(([E,C],T)=>{C&&(C(),m.set(T,[E]))})}),_=Array.isArray(d)?[]:Object.create(Object.getPrototypeOf(d)),I=e(_,{deleteProperty(S,w){const E=Reflect.get(S,w);D(w);const C=Reflect.deleteProperty(S,w);return C&&u(["delete",[w],E]),C},set(S,w,E,C){var ct;const T=Reflect.has(S,w),$=Reflect.get(S,w,C);if(T&&(t($,E)||h.has(E)&&t($,h.get(E))))return!0;D(w),J(E)&&(E=$t(E)||E);let K=E;if(!((ct=Object.getOwnPropertyDescriptor(S,w))!=null&&ct.set))if(E instanceof Promise)E.then(M=>{E.status="fulfilled",E.value=M,u(["resolve",[w],M])}).catch(M=>{E.status="rejected",E.reason=M,u(["reject",[w],M])});else{!R.has(E)&&n(E)&&(K=ot(E));const M=!W.has(K)&&R.get(K);M&&A(w,M)}return Reflect.set(S,w,K,C),u(["set",[w],E,$]),!0}});h.set(d,I);const Lt=[_,p,a,Y];return R.set(I,Lt),Reflect.ownKeys(d).forEach(S=>{const w=Object.getOwnPropertyDescriptor(d,S);w.get||w.set?Object.defineProperty(_,S,w):I[S]=d[S]}),I})=>[v,R,W,t,e,n,s,r,a,h,g],[Wt]=kt();function ot(t={}){return Wt(t)}function U(t,e,n){const s=R.get(t);let r;const a=[],h=s[3];let g=!1;const d=h(i=>{if(a.push(i),n){e(a.splice(0));return}r||(r=Promise.resolve().then(()=>{r=void 0,g&&e(a.splice(0))}))});return g=!0,()=>{g=!1,d()}}function L(t,e){const n=R.get(t),[s,r,a]=n;return a(s,r(),e)}function ut(t){return W.add(t),t}function zt(t,e){Object.keys(e).forEach(r=>{if(Object.getOwnPropertyDescriptor(t,r))throw new Error("object property already defined");const a=e[r],{get:h,set:g}=typeof a=="function"?{get:a}:a,v={};v.get=()=>h(L(s)),g&&(v.set=d=>g(s,d)),Object.defineProperty(t,r,v)});const s=ot(t);return s}var Vt=(t,e)=>Object.is(t,e);function ft(t,e,n,s,r){let a=Reflect.get(L(t),e);const h=r||Vt;function g(){const v=L(t);h(a,v[e])||(n(v[e]),a=Reflect.get(v,e))}return U(t,g,s)}function lt(t,e,n){typeof n.value=="object"&&(n.value=F(n.value)),!n.enumerable||n.get||n.set||!n.configurable||!n.writable||e==="__proto__"?Object.defineProperty(t,e,n):t[e]=n.value}function F(t){if(typeof t!="object")return t;var e=0,n,s,r,a=Object.prototype.toString.call(t);if(a==="[object Object]"?r=Object.create(t.__proto__||null):a==="[object Array]"?r=Array(t.length):a==="[object Set]"?(r=new Set,t.forEach(function(h){r.add(F(h))})):a==="[object Map]"?(r=new Map,t.forEach(function(h,g){r.set(F(g),F(h))})):a==="[object Date]"?r=new Date(+t):a==="[object RegExp]"?r=new RegExp(t.source,t.flags):a==="[object DataView]"?r=new t.constructor(F(t.buffer)):a==="[object ArrayBuffer]"?r=t.slice(0):a.slice(-6)==="Array]"&&(r=new t.constructor(t)),r){for(s=Object.getOwnPropertySymbols(t);e<s.length;e++)lt(r,s[e],Object.getOwnPropertyDescriptor(t,s[e]));for(e=0,s=Object.getOwnPropertyNames(t);e<s.length;e++)Object.hasOwnProperty.call(r,n=s[e])&&r[n]===t[n]||lt(r,n,Object.getOwnPropertyDescriptor(t,n))}return r||t}var _t=Object.defineProperty,It=(t,e,n)=>e in t?_t(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,f=(t,e,n)=>(It(t,typeof e!="symbol"?e+"":e,n),n);function Kt(t){for(;t.length>0;)t.pop();return t}var dt=(t,...e)=>(typeof t=="function"?t(...e):t)??void 0,j=t=>t,Q=()=>{},qt=(...t)=>(...e)=>{t.forEach(function(n){n==null||n(...e)})},pt=(()=>{let t=0;return()=>(t++,t.toString(36))})(),z=t=>Array.isArray(t),V=t=>!(t==null||typeof t!="object"||z(t)),Bt=t=>typeof t=="number"&&!Number.isNaN(t),O=t=>typeof t=="string",Z=t=>typeof t=="function";function X(t){if(!Gt(t)||t===void 0)return t;const e=Reflect.ownKeys(t).filter(s=>typeof s=="string"),n={};for(const s of e){const r=t[s];r!==void 0&&(n[s]=X(r))}return n}var Gt=t=>t&&typeof t=="object"&&t.constructor===Object;function H(...t){const e=t.length===1?t[0]:t[1],n=t.length===2?t[0]:!0}function G(...t){const e=t.length===1?t[0]:t[1],n=t.length===2?t[0]:!0}function xt(t,...e){for(const n of e){const s=X(n);for(const r in s)V(n[r])?(t[r]||(t[r]={}),xt(t[r],n[r])):t[r]=n[r]}return t}function gt(t){return F(t)}function x(t){return O(t)?{type:t}:t}function P(t){return t?z(t)?t.slice():[t]:[]}function At(t){return V(t)&&t.predicate!=null}var Ct=()=>!0;function Ut(t,e,n,s){return r=>{var a;return O(r)?!!((a=t[r])!=null&&a.call(t,e,n,s)):Z(r)?r(e,n,s):r.predicate(t)(e,n,s)}}function Re(t){return{predicate:e=>(n,s,r)=>{var a;return(a=t.find(h=>{const g=h.guard??Ct;return Ut(e,n,s,r)(g)}))==null?void 0:a.actions}}}function Ot(t,e){return t=t??Ct,(n,s,r)=>{if(O(t)){const a=e[t];return Z(a)?a(n,s,r):a}return At(t)?t.predicate(e)(n,s,r):t==null?void 0:t(n,s,r)}}function tt(t,e){return(n,s,r)=>At(t)?t.predicate(e)(n,s,r):t}function Zt(t){const e=t.computed??j({}),n=t.context??j({}),s=ot({value:t.initial??"",previousValue:"",event:j({}),previousEvent:j({}),context:zt(n,e),done:!1,tags:[],hasTag(r){return this.tags.includes(r)},matches(...r){return r.includes(this.value)},can(r){return j(this).nextEvents.includes(r)},get nextEvents(){var h,g;const r=((g=(h=t.states)==null?void 0:h[this.value])==null?void 0:g.on)??{},a=(t==null?void 0:t.on)??{};return Object.keys({...r,...a})},get changed(){return this.event.value==="machine.init"||!this.previousValue?!1:this.value!==this.previousValue}});return j(s)}function q(t,e){return(n,s)=>{if(Bt(t))return t;if(Z(t))return t(n,s);if(O(t)){const r=Number.parseFloat(t);if(!Number.isNaN(r))return r;if(e){const a=e==null?void 0:e[t];return G(a==null,`[@zag-js/core > determine-delay] Cannot determine delay for \`${t}\`. It doesn't exist in \`options.delays\``),Z(a)?a(n,s):a}}}}function Xt(t){return O(t)?{target:t}:t}function Yt(t,e){return(n,s,r)=>P(t).map(Xt).find(a=>Ot(a.guard,e)(n,s,r)??a.target??a.actions)}var Jt=class jt{constructor(e,n){var r,a,h,g,v,d;f(this,"status","Not Started"),f(this,"state"),f(this,"initialState"),f(this,"initialContext"),f(this,"id"),f(this,"type","machine"),f(this,"activityEvents",new Map),f(this,"delayedEvents",new Map),f(this,"stateListeners",new Set),f(this,"contextListeners",new Set),f(this,"eventListeners",new Set),f(this,"doneListeners",new Set),f(this,"contextWatchers",new Set),f(this,"removeStateListener",Q),f(this,"removeEventListener",Q),f(this,"removeContextListener",Q),f(this,"parent"),f(this,"children",new Map),f(this,"guardMap"),f(this,"actionMap"),f(this,"delayMap"),f(this,"activityMap"),f(this,"sync"),f(this,"options"),f(this,"config"),f(this,"start",i=>{if(this.state.value="",this.status==="Running")return this;this.status="Running",this.removeStateListener=U(this.state,()=>{this.stateListeners.forEach(y=>{y(this.stateSnapshot)})},this.sync),this.removeEventListener=ft(this.state,"event",y=>{this.executeActions(this.config.onEvent,y),this.eventListeners.forEach(m=>{m(y)})},this.sync),this.removeContextListener=U(this.state.context,()=>{this.log("Context:",this.contextSnapshot),this.contextListeners.forEach(y=>{y(this.contextSnapshot)})},this.sync||this.options.debug),this.setupContextWatchers(),this.executeActivities(x("machine.start"),P(this.config.activities),"machine.start"),this.executeActions(this.config.entry,x("machine.start"));const c=x("machine.init"),o=V(i)?i.value:i,u=V(i)?i.context:void 0;u&&this.setContext(u);const l={target:o??this.config.initial},p=this.getNextStateInfo(l,c);return this.initialState=p,this.performStateChangeEffects(this.state.value,p,c),this}),f(this,"setupContextWatchers",()=>{var i;for(const[c,o]of Object.entries(this.config.watch??{})){const u=(i=this.options.compareFns)==null?void 0:i[c],l=ft(this.state.context,c,()=>{this.executeActions(o,this.state.event)},this.sync,u);this.contextWatchers.add(l)}}),f(this,"stop",()=>{if(this.status!=="Stopped")return this.performExitEffects(this.state.value,x("machine.stop")),this.executeActions(this.config.exit,x("machine.stop")),this.setState(""),this.setEvent("machine.stop"),this.stopStateListeners(),this.stopChildren(),this.stopActivities(),this.stopDelayedEvents(),this.stopContextWatchers(),this.stopEventListeners(),this.stopContextListeners(),this.status="Stopped",this}),f(this,"stopEventListeners",()=>{this.eventListeners.clear(),this.removeEventListener()}),f(this,"stopContextListeners",()=>{this.contextListeners.clear(),this.removeContextListener()}),f(this,"stopStateListeners",()=>{this.removeStateListener(),this.stateListeners.clear()}),f(this,"stopContextWatchers",()=>{this.contextWatchers.forEach(i=>i()),this.contextWatchers.clear()}),f(this,"stopDelayedEvents",()=>{this.delayedEvents.forEach(i=>{i.forEach(c=>c())}),this.delayedEvents.clear()}),f(this,"stopActivities",i=>{var c,o;i?((c=this.activityEvents.get(i))==null||c.forEach(u=>u()),(o=this.activityEvents.get(i))==null||o.clear(),this.activityEvents.delete(i)):(this.activityEvents.forEach(u=>{u.forEach(l=>l()),u.clear()}),this.activityEvents.clear())}),f(this,"sendChild",(i,c)=>{const o=x(i),u=dt(c,this.contextSnapshot),l=this.children.get(u);l||G(`[@zag-js/core] Cannot send '${o.type}' event to unknown child`),l.send(o)}),f(this,"stopChild",i=>{this.children.has(i)||G(`[@zag-js/core > stop-child] Cannot stop unknown child ${i}`),this.children.get(i).stop(),this.children.delete(i)}),f(this,"removeChild",i=>{this.children.delete(i)}),f(this,"stopChildren",()=>{this.children.forEach(i=>i.stop()),this.children.clear()}),f(this,"setParent",i=>{this.parent=i}),f(this,"spawn",(i,c)=>{const o=dt(i);return c&&(o.id=c),o.type="machine.actor",o.setParent(this),this.children.set(o.id,j(o)),o.onDone(()=>{this.removeChild(o.id)}).start(),j(ut(o))}),f(this,"stopActivity",i=>{var o;if(!this.state.value)return;const c=this.activityEvents.get(this.state.value);(o=c==null?void 0:c.get(i))==null||o(),c==null||c.delete(i)}),f(this,"addActivityCleanup",(i,c,o)=>{var u;i&&(this.activityEvents.has(i)?(u=this.activityEvents.get(i))==null||u.set(c,o):this.activityEvents.set(i,new Map([[c,o]])))}),f(this,"setState",i=>{this.state.previousValue=this.state.value,this.state.value=i;const c=this.getStateNode(i);i==null?Kt(this.state.tags):this.state.tags=P(c==null?void 0:c.tags)}),f(this,"transformContext",i=>{var c,o;return(o=(c=this.options)==null?void 0:c.transformContext)==null||o.call(c,i),i}),f(this,"setContext",i=>{i&&xt(this.state.context,this.transformContext(i))}),f(this,"withContext",i=>{const c=this.transformContext(i),o={...this.config.context,...X(c)};return new jt({...this.config,context:o},this.options)}),f(this,"setOptions",i=>{const c=X(i);this.actionMap={...this.actionMap,...c.actions},this.delayMap={...this.delayMap,...c.delays},this.activityMap={...this.activityMap,...c.activities},this.guardMap={...this.guardMap,...c.guards}}),f(this,"getStateNode",i=>{var c;if(i)return(c=this.config.states)==null?void 0:c[i]}),f(this,"getNextStateInfo",(i,c)=>{const o=this.determineTransition(i,c),u=!(o!=null&&o.target),l=(o==null?void 0:o.target)??this.state.value,p=this.state.value!==l,y=this.getStateNode(l),A={reenter:!u&&!p&&!(o!=null&&o.internal),transition:o,stateNode:y,target:l,changed:p};return this.log("NextState:",`[${c.type}]`,this.state.value,"---->",A.target),A}),f(this,"getActionFromDelayedTransition",i=>{const c=x("machine.after"),u=q(i.delay,this.delayMap)(this.contextSnapshot,c);let l;return{entry:()=>{l=globalThis.setTimeout(()=>{const p=this.getNextStateInfo(i,c);this.performStateChangeEffects(this.state.value,p,c)},u)},exit:()=>{globalThis.clearTimeout(l)}}}),f(this,"getDelayedEventActions",i=>{const c=this.getStateNode(i),o=x("machine.after");if(!c||!c.after)return;const u=[],l=[];if(z(c.after)){const p=this.determineTransition(c.after,o);if(!p)return;const y=this.getActionFromDelayedTransition(p);u.push(y.entry),l.push(y.exit)}else if(V(c.after))for(const p in c.after){const y=c.after[p];let m={};if(z(y)){const D=this.determineTransition(y,o);D&&(m=D)}else O(y)?m={target:y,delay:p}:m={...y,delay:p};const A=this.getActionFromDelayedTransition(m);u.push(A.entry),l.push(A.exit)}return{entries:u,exits:l}}),f(this,"executeActions",(i,c)=>{var u;const o=tt(i,this.guardMap)(this.contextSnapshot,c,this.guardMeta);for(const l of P(o)){const p=O(l)?(u=this.actionMap)==null?void 0:u[l]:l;H(O(l)&&!p,`[@zag-js/core > execute-actions] No implementation found for action: \`${l}\``),p==null||p(this.state.context,c,this.meta)}}),f(this,"executeActivities",(i,c,o)=>{var u;for(const l of c){const p=O(l)?(u=this.activityMap)==null?void 0:u[l]:l;if(!p){H(`[@zag-js/core > execute-activity] No implementation found for activity: \`${l}\``);continue}const y=p(this.state.context,i,this.meta);if(y){const m=O(l)?l:l.name||pt();this.addActivityCleanup(o??this.state.value,m,y)}}}),f(this,"createEveryActivities",(i,c)=>{if(!i)return;const o=x("machine.every");if(z(i)){const u=P(i).find(m=>{const A=m.delay,Y=q(A,this.delayMap)(this.contextSnapshot,o);return Ot(m.guard,this.guardMap)(this.contextSnapshot,o,this.guardMeta)??Y!=null});if(!u)return;const p=q(u.delay,this.delayMap)(this.contextSnapshot,o);c(()=>{const m=globalThis.setInterval(()=>{this.executeActions(u.actions,o)},p);return()=>{globalThis.clearInterval(m)}})}else for(const u in i){const l=i==null?void 0:i[u],y=q(u,this.delayMap)(this.contextSnapshot,o);c(()=>{const A=globalThis.setInterval(()=>{this.executeActions(l,o)},y);return()=>{globalThis.clearInterval(A)}})}}),f(this,"setEvent",i=>{this.state.previousEvent=this.state.event,this.state.event=ut(x(i))}),f(this,"performExitEffects",(i,c)=>{const o=this.state.value;if(o==="")return;const u=i?this.getStateNode(i):void 0;this.stopActivities(o);const l=tt(u==null?void 0:u.exit,this.guardMap)(this.contextSnapshot,c,this.guardMeta),p=P(l),y=this.delayedEvents.get(o);y&&p.push(...y),this.executeActions(p,c),this.eventListeners.clear()}),f(this,"performEntryEffects",(i,c)=>{const o=this.getStateNode(i),u=P(o==null?void 0:o.activities);this.createEveryActivities(o==null?void 0:o.every,m=>{u.unshift(m)}),u.length>0&&this.executeActivities(c,u);const l=tt(o==null?void 0:o.entry,this.guardMap)(this.contextSnapshot,c,this.guardMeta),p=P(l),y=this.getDelayedEventActions(i);o!=null&&o.after&&y&&(this.delayedEvents.set(i,y==null?void 0:y.exits),p.push(...y.entries)),this.executeActions(p,c),(o==null?void 0:o.type)==="final"&&(this.state.done=!0,this.doneListeners.forEach(m=>{m(this.stateSnapshot)}),this.stop())}),f(this,"performTransitionEffects",(i,c)=>{const o=this.determineTransition(i,c);this.executeActions(o==null?void 0:o.actions,c)}),f(this,"performStateChangeEffects",(i,c,o)=>{this.setEvent(o);const u=c.changed||c.reenter;u&&this.performExitEffects(i,o),this.performTransitionEffects(c.transition,o),this.setState(c.target),u&&this.performEntryEffects(c.target,o)}),f(this,"determineTransition",(i,c)=>{const o=Yt(i,this.guardMap);return o==null?void 0:o(this.contextSnapshot,c,this.guardMeta)}),f(this,"sendParent",i=>{var o;this.parent||G("[@zag-js/core > send-parent] Cannot send event to an unknown parent");const c=x(i);(o=this.parent)==null||o.send(c)}),f(this,"log",(...i)=>{}),f(this,"send",i=>{const c=x(i);this.transition(this.state.value,c)}),f(this,"transition",(i,c)=>{var y,m;const o=O(i)?this.getStateNode(i):i==null?void 0:i.stateNode,u=x(c);if(!o&&!this.config.on){const A=this.status==="Stopped"?"[@zag-js/core > transition] Cannot transition a stopped machine":`[@zag-js/core > transition] State does not have a definition for \`state\`: ${i}, \`event\`: ${u.type}`;H(A);return}const l=((y=o==null?void 0:o.on)==null?void 0:y[u.type])??((m=this.config.on)==null?void 0:m[u.type]),p=this.getNextStateInfo(l,u);return this.performStateChangeEffects(this.state.value,p,u),p.stateNode}),f(this,"subscribe",i=>(this.stateListeners.add(i),this.status==="Running"&&i(this.stateSnapshot),()=>{this.stateListeners.delete(i)})),f(this,"onDone",i=>(this.doneListeners.add(i),this)),f(this,"onTransition",i=>(this.stateListeners.add(i),this.status==="Running"&&i(this.stateSnapshot),this)),f(this,"onChange",i=>(this.contextListeners.add(i),this)),f(this,"onEvent",i=>(this.eventListeners.add(i),this)),this.config=gt(e),this.options=gt(n??{}),this.id=this.config.id??`machine-${pt()}`,this.guardMap=((r=this.options)==null?void 0:r.guards)??{},this.actionMap=((a=this.options)==null?void 0:a.actions)??{},this.delayMap=((h=this.options)==null?void 0:h.delays)??{},this.activityMap=((g=this.options)==null?void 0:g.activities)??{},this.sync=((v=this.options)==null?void 0:v.sync)??!1,this.state=Zt(this.config),this.initialContext=L(this.state.context),this.transformContext(this.state.context);const s=x("machine.created");this.executeActions((d=this.config)==null?void 0:d.created,s)}get stateSnapshot(){return j(L(this.state))}getState(){return this.stateSnapshot}get contextSnapshot(){return this.stateSnapshot.context}get self(){const e=this;return{id:this.id,send:this.send.bind(this),sendParent:this.sendParent.bind(this),sendChild:this.sendChild.bind(this),stop:this.stop.bind(this),stopChild:this.stopChild.bind(this),spawn:this.spawn.bind(this),stopActivity:this.stopActivity.bind(this),get state(){return e.stateSnapshot},get initialContext(){return e.initialContext},get initialState(){var n;return((n=e.initialState)==null?void 0:n.target)??""}}}get meta(){var e;return{state:this.stateSnapshot,guards:this.guardMap,send:this.send.bind(this),self:this.self,initialContext:this.initialContext,initialState:((e=this.initialState)==null?void 0:e.target)??"",getState:()=>this.stateSnapshot,getAction:n=>this.actionMap[n],getGuard:n=>this.guardMap[n]}}get guardMeta(){return{state:this.stateSnapshot}}get[Symbol.toStringTag](){return"Machine"}},De=(t,e)=>new Jt(t,e),Qt=(...t)=>t.map(e=>{var n;return(n=e==null?void 0:e.trim)==null?void 0:n.call(e)}).filter(Boolean).join(" "),Ht=/^on[A-Z]/;function te(...t){let e={};for(let n of t){for(let s in e){if(Ht.test(s)&&typeof e[s]=="function"&&typeof n[s]=="function"){e[s]=qt(e[s],n[s]);continue}if(s==="className"||s==="class"){e[s]=Qt(e[s],n[s]);continue}if(s==="style"){e[s]=Object.assign({},e[s]??{},n[s]??{});continue}e[s]=n[s]!==void 0?n[s]:e[s]}for(let s in n)e[s]===void 0&&(e[s]=n[s])}return e}function ee(t){return new Proxy({},{get(){return t}})}var Te=ee(t=>t),ne=typeof document<"u"?b.useLayoutEffect:b.useEffect,{use:yt}=Rt,se=new WeakMap;function ie(t,e){const n=e==null?void 0:e.sync,s=b.useRef(),r=b.useRef(),a=b.useSyncExternalStore(b.useCallback(v=>{const d=U(t,v,n);return v(),d},[t,n]),()=>{const v=L(t,yt);try{if(s.current&&r.current&&!bt(s.current,v,r.current,new WeakMap))return s.current}catch{}return v},()=>L(t,yt)),h=new WeakMap;b.useEffect(()=>{s.current=a,r.current=h});const g=b.useMemo(()=>new WeakMap,[]);return St(a,h,g,se)}function re(t){const e=b.useRef();return e.current||(e.current={v:t()}),e.current.v}function oe(t,e){const{actions:n,state:s,context:r}=e??{},a=re(()=>{const h=typeof t=="function"?t():t;return r?h.withContext(r):h});return ne(()=>(a.start(s),a.state.can("SETUP")&&a.send("SETUP"),()=>{a.stop()}),[]),a.setOptions({actions:n}),a.setContext(r),a}function Ne(t,e){const n=oe(t,e);return[ie(n.state),n.send,n]}const Fe=()=>(t,e)=>e.reduce((n,s)=>{const[r,a]=n,h=s;return a[h]!==void 0&&(r[h]=a[h]),delete a[h],[r,a]},[{},{...t}]);function ce(t,e){typeof t=="function"?t(e):t!=null&&(t.current=e)}function ae(...t){return e=>t.forEach(n=>ce(n,e))}const et=t=>{const e=b.forwardRef((n,s)=>{const{asChild:r,children:a,...h}=n;if(!r)return Dt.jsx(t,{...n,ref:s});const g=b.Children.only(a);return b.isValidElement(g)?b.cloneElement(g,{...te(h,g.props),ref:s?ae(s,g.ref):g.ref}):null});return e.displayName=t.displayName||t.name,e},he=()=>{const t=new Map;return new Proxy(et,{apply(e,n,s){return et(s[0])},get(e,n){const s=n;return t.has(s)||t.set(s,et(s)),t.get(s)}})},$e=he();function ke(t,e={}){const{sync:n=!1}=e,s=ue(t);return b.useCallback((...r)=>{var a;return n?queueMicrotask(()=>{var h;return(h=s.current)==null?void 0:h.call(s,...r)}):(a=s.current)==null?void 0:a.call(s,...r)},[n,s])}function ue(t){const e=b.useRef(t);return e.current=t,e}function fe(t,e){return`${t} returned \`undefined\`. Seems you forgot to wrap component within ${e}`}function le(t={}){const{name:e,strict:n=!0,hookName:s="useContext",providerName:r="Provider",errorMessage:a}=t,h=b.createContext(void 0);h.displayName=e;function g(){var d;const v=b.useContext(h);if(!v&&n){const i=new Error(a??fe(s,r));throw i.name="ContextError",(d=Error.captureStackTrace)==null||d.call(Error,i,g),i}return v}return[h.Provider,g,h]}var nt=(t,e=[])=>({parts:(...n)=>{if(de(e))return nt(t,n);throw new Error("createAnatomy().parts(...) should only be called once. Did you mean to use .extendWith(...) ?")},extendWith:(...n)=>nt(t,[...e,...n]),rename:n=>nt(n,e),keys:()=>e,build:()=>[...new Set(e)].reduce((n,s)=>Object.assign(n,{[s]:{selector:[`&[data-scope="${N(t)}"][data-part="${N(s)}"]`,`& [data-scope="${N(t)}"][data-part="${N(s)}"]`].join(", "),attrs:{"data-scope":N(t),"data-part":N(s)}}}),{})}),N=t=>t.replace(/([A-Z])([A-Z])/g,"$1-$2").replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[\s_]+/g,"-").toLowerCase(),de=t=>t.length===0,We=t=>t?"":void 0,ze=t=>t?"true":void 0,pe=t=>t.nodeType===Node.DOCUMENT_NODE?t:t.ownerDocument??document;function Ve(t){const e={getRootNode:n=>{var s;return((s=n.getRootNode)==null?void 0:s.call(n))??document},getDoc:n=>pe(e.getRootNode(n)),getWin:n=>e.getDoc(n).defaultView??window,getActiveElement:n=>e.getDoc(n).activeElement,isActiveElement:(n,s)=>s===e.getActiveElement(n),focus(n,s){s!=null&&(e.isActiveElement(n,s)||s.focus({preventScroll:!0}))},getById:(n,s)=>e.getRootNode(n).getElementById(s),setValue:(n,s)=>{if(n==null||s==null)return;const r=s.toString();n.value!==r&&(n.value=s.toString())}};return{...e,...t}}function _e(t){const{selectionStart:e,selectionEnd:n,value:s}=t.currentTarget;return s.slice(0,e)+t.data+s.slice(n)}function Ie(t,e){return Array.from((t==null?void 0:t.querySelectorAll(e))??[])}function Ke(t){const e=globalThis.requestAnimationFrame(t);return()=>{globalThis.cancelAnimationFrame(e)}}var qe=t=>t.button===0,Be=t=>t.ctrlKey||t.altKey||t.metaKey,ge={Up:"ArrowUp",Down:"ArrowDown",Esc:"Escape"," ":"Space",",":"Comma",Left:"ArrowLeft",Right:"ArrowRight"},vt={ArrowLeft:"ArrowRight",ArrowRight:"ArrowLeft"};function Ge(t,e={}){const{dir:n="ltr",orientation:s="horizontal"}=e;let{key:r}=t;return r=ge[r]??r,n==="rtl"&&s==="horizontal"&&r in vt&&(r=vt[r]),r}function ye(t,e="client"){const n=t.touches[0]||t.changedTouches[0];return{x:n[`${e}X`],y:n[`${e}Y`]}}function ve(t,e="client"){return{x:t[`${e}X`],y:t[`${e}Y`]}}var me=t=>"touches"in t&&t.touches.length>0;function Ue(t,e="client"){return me(t)?ye(t,e):ve(t,e)}function Ze(t){return t.nativeEvent??t}function mt(t){return Math.max(0,Math.min(1,t))}function Xe(t,e){const{left:n,top:s,width:r,height:a}=e.getBoundingClientRect(),h={x:t.x-n,y:t.y-s},g={x:mt(h.x/r),y:mt(h.y/a)};function v(d={}){const{dir:i="ltr",orientation:c="horizontal",inverted:o}=d,u=typeof o=="object"?o.x:o,l=typeof o=="object"?o.y:o;return c==="horizontal"?i==="rtl"||u?1-g.x:g.x:l?1-g.y:g.y}return{offset:h,percent:g,getPercentValue:v}}var Ye=(t,e)=>{if(Object.is(t,e))return!0;if(!(t instanceof Object)||!(e instanceof Object))return!1;const n=Object.keys(t),s=n.length;for(let r=0;r<s;r++)if(!(n[r]in e))return!1;for(let r=0;r<s;r++)if(t[n[r]]!==e[n[r]])return!1;return s===Object.keys(e).length};function Ee(t){if(!we(t)||t===void 0)return t;const e=Reflect.ownKeys(t).filter(s=>typeof s=="string"),n={};for(const s of e){const r=t[s];r!==void 0&&(n[s]=Ee(r))}return n}var we=t=>t&&typeof t=="object"&&t.constructor===Object;function Je(...t){const e=t.length===1?t[0]:t[1],n=t.length===2?t[0]:!0}const[Qe,He]=le({name:"EnvironmentContext",hookName:"useEnvironmentContext",providerName:"<EnvironmentProvider />",strict:!1});function Se(t,e,n){if(!t)return;const s=t.ownerDocument.defaultView||window,r=new s.MutationObserver(a=>{for(const h of a)h.type==="attributes"&&h.attributeName&&e.includes(h.attributeName)&&n(h)});return r.observe(t,{attributes:!0,attributeFilter:e}),()=>r.disconnect()}var Mt=t=>t.ownerDocument.defaultView||window;function be(t,e){const{type:n="HTMLInputElement",property:s="value"}=e,r=Mt(t)[n].prototype;return Object.getOwnPropertyDescriptor(r,s)??{}}function xe(t,e,n={}){var r;(r=be(t,n).set)==null||r.call(t,e)}function tn(t,e){const{value:n,bubbles:s=!0}=e;if(!t)return;const r=Mt(t);t instanceof r.HTMLInputElement&&(xe(t,`${n}`),t.dispatchEvent(new r.Event("input",{bubbles:s})))}function Ae(t){return Ce(t)?t.form:t.closest("form")}function Ce(t){return t.matches("textarea, input, select, button")}function Oe(t,e){if(!t)return;const n=Ae(t);return n==null||n.addEventListener("reset",e,{passive:!0}),()=>{n==null||n.removeEventListener("reset",e)}}function je(t,e){const n=t==null?void 0:t.closest("fieldset");if(n)return e(n.disabled),Se(n,["disabled"],()=>e(n.disabled))}function en(t,e){if(!t)return;const{onFieldsetDisabledChange:n,onFormReset:s}=e,r=[Oe(t,s),je(t,n)];return()=>{r.forEach(a=>a==null?void 0:a())}}export{Xe as A,en as B,Ve as a,ze as b,nt as c,We as d,Ze as e,Be as f,_e as g,Ge as h,Je as i,Ee as j,De as k,Re as l,Ye as m,tn as n,le as o,ke as p,Ie as q,Ke as r,Ne as s,Te as t,He as u,Fe as v,te as w,$e as x,qe as y,Ue as z};
